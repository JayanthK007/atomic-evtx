{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.1732811"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:45.5005995"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=1557102d-bc1d-4164-bae0-7751454c75f7\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 13:36:52.5160685"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=cf518a5a-002c-4f85-b1f9-77d907ff4607\r\n\tHostApplication=powershell.exe &amp; {$FilterArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n EventNameSpace='root\\CimV2';\r\n QueryLanguage=\"WQL\";\r\n Query=\"SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325\"};\r\n$Filter=Set-WmiInstance -Class __EventFilter -Namespace \"root\\subscription\" -Arguments $FilterArgs\r\n\r\n$ConsumerArgs = @{name='file-WMIPersistence-ActiveScriptEventConsumer-Example';\r\n ScriptingEngine='VBScript';\r\n ScriptText='\r\n Set objws = CreateObject(\"Wscript.Shell\")\r\n objws.Run \"notepad.exe\", 0, True\r\n '}\r\n$Consumer=Set-WmiInstance -Namespace \"root\\subscription\" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs\r\n\r\n$FilterToConsumerArgs = @{\r\nFilter = $Filter;\r\nConsumer = $Consumer;\r\n}\r\n$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=1557102d-bc1d-4164-bae0-7751454c75f7\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
