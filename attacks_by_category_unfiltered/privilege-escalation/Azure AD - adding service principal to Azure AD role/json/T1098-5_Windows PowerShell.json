{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2161900"},"EventRecordID":"1152","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2355499"},"EventRecordID":"1153","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2575840"},"EventRecordID":"1154","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2607533"},"EventRecordID":"1155","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2607533"},"EventRecordID":"1156","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.2607533"},"EventRecordID":"1157","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:32.6981096"},"EventRecordID":"1158","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=96edc4df-e254-4cc9-9074-8cfe13367661\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:34.0302483"},"EventRecordID":"1159","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Certificate, Started, \tProviderName=Certificate\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=96edc4df-e254-4cc9-9074-8cfe13367661\r\n\tPipelineId=2\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 09:45:34.2754735"},"EventRecordID":"1160","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=17\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2a9c59c-cb21-49e7-87ff-be3ffcb1132e\r\n\tHostApplication=powershell.exe &amp; {Import-Module -Name AzureAD\r\n$PWord = ConvertTo-SecureString -String \"p4sswd\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"jonh@contoso.com\", $Pword\r\nConnect-AzureAD -Credential $Credential\r\n\r\n$sp = Get-AzureADServicePrincipal -Filter \"DisplayName eq 'SuperSP'\"\r\nif ($sp -eq $null) { Write-Warning \"Service Principal not found\"; exit }\r\n$role = Get-AzureADDirectoryRole -Filter \"DisplayName eq 'Global Reader'\"\r\nif ($role -eq $null) { Write-Warning \"Role not found\"; exit }\r\nAdd-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId\r\nWrite-Host \"Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=96edc4df-e254-4cc9-9074-8cfe13367661\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
