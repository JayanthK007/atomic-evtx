{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9418385"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9579136"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9579136"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9671710"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9671710"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:02.9671710"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:03.0432606"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=8e14883a-d647-4278-b7ca-c7d05fb4ea76\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:03.4977603"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Certificate, Started, \tProviderName=Certificate\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=8e14883a-d647-4278-b7ca-c7d05fb4ea76\r\n\tPipelineId=2\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 20:58:03.8651666"},"EventRecordID":"1051","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=17\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=ee0486de-98c3-42cd-ac6d-182274a1b872\r\n\tHostApplication=powershell.exe &amp; {$termsrvDll = \"C:\\Windows\\System32\\termsrv.dll\"\r\n\r\n$ACL = Get-Acl $termsrvDll\r\n$permission = \"Administrators\",\"FullControl\",\"Allow\"\r\n$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule $permission\r\n$ACL.SetAccessRule($accessRule)\r\nSet-Acl -Path $termsrvDll -AclObject $ACL\r\n\r\nCopy-Item -Path $termsrvDll -Destination \"$HOME\\AtomicTest.dll\"\r\n\r\n$newServiceDll = \"$HOME\\AtomicTest.dll\"\r\n\r\n$registryPath = \"HKLM:\\System\\CurrentControlSet\\services\\TermService\\Parameters\"\r\n\r\n# Check if the registry key exists\r\nif (Test-Path -Path $registryPath) {\r\n # Modify the ServiceDll value in the registry\r\n Set-ItemProperty -Path $registryPath -Name \"ServiceDll\" -Value $newServiceDll\r\n Write-Host \"ServiceDll value in the registry has been updated to: $newServiceDll\"\r\n} else {\r\n Write-Host \"Registry key not found. Make sure the 'TermService\\Parameters' key exists.\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=8e14883a-d647-4278-b7ca-c7d05fb4ea76\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
