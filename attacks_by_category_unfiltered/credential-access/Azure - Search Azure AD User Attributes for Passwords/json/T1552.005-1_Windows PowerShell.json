{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.8570038"},"EventRecordID":"1094","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.8973272"},"EventRecordID":"1095","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.8973272"},"EventRecordID":"1096","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.9238268"},"EventRecordID":"1097","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.9238268"},"EventRecordID":"1098","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:14.9238268"},"EventRecordID":"1099","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:15.1679086"},"EventRecordID":"1100","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=5d4e819a-bcb4-40dd-a6ce-efc65ca150ea\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:16.3583290"},"EventRecordID":"1101","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Certificate, Started, \tProviderName=Certificate\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=5d4e819a-bcb4-40dd-a6ce-efc65ca150ea\r\n\tPipelineId=2\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-27 20:23:16.8429246"},"EventRecordID":"1102","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=18\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=e2d8ca47-7438-46ec-9564-2d75f966bd88\r\n\tHostApplication=powershell.exe &amp; {import-module msonline\r\n$Password = ConvertTo-SecureString -String \"T1082Az\" -AsPlainText -Force\r\n$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \"\", $Password\r\nConnect-MsolService -Credential $Credential\r\n$users = Get-MsolUser -All;\r\nforeach($user in $users)\r\n{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; \r\nforeach($prop in $props)\r\n{if($user.$prop -like \"*password*\")\r\n{(\"[*]\" + $user.UserPrincipalName + \"[\" + $prop + \"]\" + \" : \" + $user.$prop) | out-file -filepath $env:temp\\T1552.005Test1.txt -append -force}}}\r\nget-content -path $env:temp\\T1552.005Test1.txt -erroraction silentlycontinue}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=5d4e819a-bcb4-40dd-a6ce-efc65ca150ea\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
