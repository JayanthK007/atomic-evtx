{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:20.9784763"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:20.9893164"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:20.9955247"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:21.0022305"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:21.0022305"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:21.0022305"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:21.2146936"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=f1cc2ce2-f133-4074-9d0b-92fee1777cef\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-21 08:46:23.2925149"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=0f6253ea-a8fc-49cf-95f7-d5b30b2a2a46\r\n\tHostApplication=powershell.exe &amp; {$ports = Get-content \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\T1016\\src\\top-128.txt\"\r\n$file = \"$env:USERPROFILE\\Desktop\\open-ports.txt\"\r\n$totalopen = 0\r\n$totalports = 0\r\nNew-Item $file -Force\r\nforeach ($port in $ports) {\r\n $test = new-object system.Net.Sockets.TcpClient\r\n $wait = $test.beginConnect(\"allports.exposed\", $port, $null, $null)\r\n $wait.asyncwaithandle.waitone(250, $false) | Out-Null\r\n $totalports++ | Out-Null\r\n if ($test.Connected) {\r\n $result = \"$port open\" \r\n Write-Host -ForegroundColor Green $result\r\n $result | Out-File -Encoding ASCII -append $file\r\n $totalopen++ | Out-Null\r\n }\r\n else {\r\n $result = \"$port closed\" \r\n Write-Host -ForegroundColor Red $result\r\n $totalclosed++ | Out-Null\r\n $result | Out-File -Encoding ASCII -append $file\r\n }\r\n}\r\n$results = \"There were a total of $totalopen open ports out of $totalports ports tested.\"\r\n$results | Out-File -Encoding ASCII -append $file\r\nWrite-Host $results}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=f1cc2ce2-f133-4074-9d0b-92fee1777cef\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
