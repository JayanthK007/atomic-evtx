{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.4928518"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.4928518"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.4928518"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.5069570"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.5069570"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.5069570"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:23.8018131"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fab6f44c-d9dd-4a93-81c8-d6d6d4059308\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:25.1946412"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Certificate, Started, \tProviderName=Certificate\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fab6f44c-d9dd-4a93-81c8-d6d6d4059308\r\n\tPipelineId=4\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:26.3494288"},"EventRecordID":"1075","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"        Add-Type -TypeDefinition $Source -ReferencedAssemblies 'System.Configuration.Install' -OutputAssembly $OutputAssemblyFullPath -ErrorAction Stop\r\n, \tDetailSequence=1\r\n\tDetailTotal=1\r\n\r\n\tSequenceNumber=17\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fab6f44c-d9dd-4a93-81c8-d6d6d4059308\r\n\tPipelineId=1\r\n\tScriptName=C:\\Users\\admin_test\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\r\n\tCommandLine=        Add-Type -TypeDefinition $Source -ReferencedAssemblies 'System.Configuration.Install' -OutputAssembly $OutputAssemblyFullPath -ErrorAction Stop\r\n, CommandInvocation(Add-Type): \"Add-Type\"\r\nParameterBinding(Add-Type): name=\"TypeDefinition\"; value=\"        using System;\r\n        using System.IO;\r\n        using System.Configuration.Install;\r\n        using System.ComponentModel;\r\n\r\n        [RunInstaller(true)]\r\n        public class InstallUtilfileTest : Installer\r\n        {\r\n            public InstallUtilfileTest()\r\n            {\r\n                using (StreamWriter w = File.AppendText(@\"C:\\Users\\admin_test\\AppData\\Local\\Temp\\tmp936C.tmp\")) {\r\n                    w.Write(\"Constructor_\");\r\n                }\r\n            }\r\n        }\"\r\nParameterBinding(Add-Type): name=\"ReferencedAssemblies\"; value=\"System.Configuration.Install\"\r\nParameterBinding(Add-Type): name=\"OutputAssembly\"; value=\"C:\\Windows\\System32\\Tasks\\readme.txt\"\r\nParameterBinding(Add-Type): name=\"ErrorAction\"; value=\"Stop\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:26.6069968"},"EventRecordID":"1076","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"        Add-Type -MemberDefinition $Signature -Name NativeMethods -Namespace GetCommandLineArgumentHelper\r\n, \tDetailSequence=1\r\n\tDetailTotal=1\r\n\r\n\tSequenceNumber=19\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fab6f44c-d9dd-4a93-81c8-d6d6d4059308\r\n\tPipelineId=1\r\n\tScriptName=C:\\Users\\admin_test\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\r\n\tCommandLine=        Add-Type -MemberDefinition $Signature -Name NativeMethods -Namespace GetCommandLineArgumentHelper\r\n, CommandInvocation(Add-Type): \"Add-Type\"\r\nParameterBinding(Add-Type): name=\"MemberDefinition\"; value=\"        [DllImport(\"shell32.dll\", CharSet = CharSet.Unicode)]\r\n        public static extern IntPtr CommandLineToArgvW([MarshalAs(UnmanagedType.LPWStr)] string cmdLine, out int numArgs);\r\n\r\n        [DllImport(\"kernel32.dll\")]\r\n        public static extern IntPtr LocalFree(IntPtr hMem);, ...\"\r\nParameterBinding(Add-Type): name=\"Name\"; value=\"NativeMethods\"\r\nParameterBinding(Add-Type): name=\"Namespace\"; value=\"GetCommandLineArgumentHelper\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-26 13:46:27.9455756"},"EventRecordID":"1077","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=21\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=8ef300cc-02ea-4877-8e32-6d411a061d02\r\n\tHostApplication=powershell.exe &amp; {# Import the required test harness function, Invoke-BuildAndInvokeInstallUtilAssembly\r\n. \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\data.004\\src\\InstallUtilTestHarness.ps1\"\r\n\r\n$InstallerAssemblyDir = \"$Env:windir\\System32\\Tasks\"\r\n$InstallerAssemblyFileName = 'readme.txt'\r\n$InstallerAssemblyFullPath = Join-Path -Path $InstallerAssemblyDir -ChildPath $InstallerAssemblyFileName\r\n\r\n$CommandLine = \"readme.txt\"\r\n$ExpectedOutput = 'Constructor_'\r\n\r\n# Explicitly set the directory so that a relative path to readme.txt can be supplied.\r\nSet-Location \"$Env:windir\\System32\\Tasks\"\r\n\r\nCopy-Item -Path \"$([System.Runtime.InteropServices.RuntimeEnvironment]::GetRuntimeDirectory())InstallUtil.exe\" -Destination \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n\r\n$TestArgs = @{\r\n OutputAssemblyDirectory = $InstallerAssemblyDir\r\n OutputAssemblyFileName = $InstallerAssemblyFileName\r\n InvocationMethod = 'Executable'\r\n CommandLine = $CommandLine\r\n InstallUtilPath = \"$Env:windir\\System32\\Tasks\\notepad.exe\"\r\n}\r\n\r\n$ActualOutput = Invoke-BuildAndInvokeInstallUtilAssembly @TestArgs -MinimumViableAssembly\r\n\r\nif ($ActualOutput -ne $ExpectedOutput) {\r\n throw @\"\r\nEvasive Installutil invocation test failure. Installer assembly execution output did not match the expected output.\r\nExpected: $ExpectedOutput\r\nActual: $ActualOutput\r\n\"@\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=fab6f44c-d9dd-4a93-81c8-d6d6d4059308\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
