{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.6718752"},"EventRecordID":"1083","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.6814262"},"EventRecordID":"1084","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.6814262"},"EventRecordID":"1085","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.7053859"},"EventRecordID":"1086","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.7053859"},"EventRecordID":"1087","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.7053859"},"EventRecordID":"1088","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:23.9905394"},"EventRecordID":"1089","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=942666b4-4882-40a2-ac22-39a657626100\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 10:16:24.9408580"},"EventRecordID":"1090","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=5fbd480d-613b-4a8a-af70-13f6db261b2a\r\n\tHostApplication=powershell.exe &amp; {$credFile = \"$env:LOCALAPPDATA\\AtomicRedTeam\\$env:USERNAME.txt\"\r\nif (Test-Path $credFile) {\r\n $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)\r\n if($cred.GetNetworkCredential().Password -eq \"UpperLowerLong-special\"){\r\n Write-Host -ForegroundColor Yellow \"The new password is the same as the password stored in the credential file. Please specify a different new password.\"; exit -1\r\n }\r\n try {\r\n $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force\r\n Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword\r\n }\r\n catch { \r\n $_.Exception\r\n $errCode = $_.Exception.ErrorCode\r\n Write-Host \"Error code: $errCode\"\r\n if ($errCode -eq 86) {\r\n Write-Host -ForegroundColor Yellow \"The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\"\r\n Remove-Item $credFile\r\n }\r\n exit $errCode\r\n }\r\n Write-Host -ForegroundColor Cyan \"Successfully changed the password to UpperLowerLong-special\"\r\n $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \"UpperLowerLong-special\" -AsPlainText -Force))\r\n $newCred.Password | ConvertFrom-SecureString | Out-File $credFile\r\n}\r\nelse {\r\n Write-Host -ForegroundColor Yellow \"You must store the password of the current user by running the prerequisite commands first\"\r\n}}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=942666b4-4882-40a2-ac22-39a657626100\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
