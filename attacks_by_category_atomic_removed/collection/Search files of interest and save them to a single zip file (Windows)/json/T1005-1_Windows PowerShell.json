{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7306415"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7395714"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7430115"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7453373"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7453373"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.7453373"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:22.8824014"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=9ace0572-f4aa-4789-af10-460722aacadf\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:23.9250933"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"        Add-Type -AssemblyName System.IO.Compression\r\n, \tDetailSequence=1\r\n\tDetailTotal=1\r\n\r\n\tSequenceNumber=15\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=9ace0572-f4aa-4789-af10-460722aacadf\r\n\tPipelineId=1\r\n\tScriptName=C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Archive\\Microsoft.PowerShell.Archive.psm1\r\n\tCommandLine=        Add-Type -AssemblyName System.IO.Compression\r\n, CommandInvocation(Add-Type): \"Add-Type\"\r\nParameterBinding(Add-Type): name=\"AssemblyName\"; value=\"System.IO.Compression\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"800"},"Version":"0","Level":"4","Task":"8","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:23.9394089"},"EventRecordID":"1051","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"        Add-Type -AssemblyName System.IO.Compression.FileSystem\r\n, \tDetailSequence=1\r\n\tDetailTotal=1\r\n\r\n\tSequenceNumber=17\r\n\r\n\tUserId=SERVER002\\admin_test\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=9ace0572-f4aa-4789-af10-460722aacadf\r\n\tPipelineId=1\r\n\tScriptName=C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules\\Microsoft.PowerShell.Archive\\Microsoft.PowerShell.Archive.psm1\r\n\tCommandLine=        Add-Type -AssemblyName System.IO.Compression.FileSystem\r\n, CommandInvocation(Add-Type): \"Add-Type\"\r\nParameterBinding(Add-Type): name=\"AssemblyName\"; value=\"System.IO.Compression.FileSystem\"\r\n","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 20:55:24.1216207"},"EventRecordID":"1052","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=19\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=219944af-2078-4614-8099-48e0a93226d8\r\n\tHostApplication=powershell.exe &amp; {$startingDirectory = \"C:\\Users\"\r\n$outputZip = \"C:\\Users\\ADMIN_~1\\AppData\\Local\\Temp\\file\\..\\Externalfiles\\T1005\"\r\n$fileExtensionsString = \".doc, .docx, .txt\" \r\n$fileExtensions = $fileExtensionsString -split \", \"\r\n\r\nNew-Item -Type Directory $outputZip -ErrorAction Ignore -Force | Out-Null\r\n\r\nFunction Search-Files {\r\n param (\r\n [string]$directory\r\n )\r\n $files = Get-ChildItem -Path $directory -File -Recurse | Where-Object {\r\n $fileExtensions -contains $_.Extension.ToLower()\r\n }\r\n return $files\r\n}\r\n\r\n$foundFiles = Search-Files -directory $startingDirectory\r\nif ($foundFiles.Count -gt 0) {\r\n $foundFilePaths = $foundFiles.FullName\r\n Compress-Archive -Path $foundFilePaths -DestinationPath \"$outputZip\\data.zip\"\r\n\r\n Write-Host \"Zip file created: $outputZip\\data.zip\"\r\n } else {\r\n Write-Host \"No files found with the specified extensions.\"\r\n }}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=9ace0572-f4aa-4789-af10-460722aacadf\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
